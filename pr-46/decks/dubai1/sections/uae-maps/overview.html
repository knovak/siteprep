<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UAE Maps | Dubai1 Deck</title>
  <link rel="stylesheet" href="../../assets/styles.css">
  <link rel="manifest" href="../../../../../manifest.webmanifest">
  <script defer src="../../assets/scripts.js"></script>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>

  <style>
    .map-section {
      background: white;
      margin: 20px 0;
      padding: 20px;
      border-radius: 8px;
    }
    .map-container {
      height: 600px;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin: 15px 0;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 15px 0;
    }
    .controls button {
      background: #2196F3;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    .controls button:hover {
      background: #1976D2;
    }
    .custom-popup .leaflet-popup-content-wrapper {
      border-radius: 8px;
      padding: 0;
    }
    .custom-popup .leaflet-popup-content {
      margin: 0;
      min-width: 200px;
    }
    .popup-header {
      color: white;
      padding: 12px 15px;
      border-radius: 8px 8px 0 0;
    }
    .popup-body {
      padding: 15px;
    }
    @media (max-width: 768px) {
      .map-container {
        height: 400px;
      }
      .controls button {
        font-size: 12px;
        padding: 8px 12px;
      }
    }
  </style>
</head>
<body>
  <article class="card">
    <div class="card-header">
      <p class="tag">Maps</p>
      <h1>UAE Maps</h1>
    </div>
    <div class="card-content">
      <p>Interactive maps showing key locations across Dubai and Abu Dhabi including cultural sites, hotels, and landmarks. Use the buttons below each map to navigate to specific locations.</p>
    </div>
  </article>

  <div class="map-section">
    <h2>OpenStreetMap Standard</h2>
    <div id="map1" class="map-container"></div>
    <div class="controls" id="controls1"></div>
  </div>

  <div class="map-section">
    <h2>OpenTopoMap</h2>
    <div id="map2" class="map-container"></div>
    <div class="controls" id="controls2"></div>
  </div>

  <article class="card">
    <div class="card-header">
      <h2>Google Maps links</h2>
    </div>
    <div class="card-content">
      <p>Use these links to open each marked location directly in Google Maps.</p>
      <ul id="maps-links"></ul>
    </div>
  </article>

  <article class="card">
    <div class="card-content">
      <div id="page-nav"></div>
    </div>
  </article>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
          crossorigin=""></script>

  <footer class="site-footer">
    <div class="footer-nav">
      <a href="../../../../index.html">Version: main</a>
      <span class="footer-separator">|</span>
      <a href="../../index.html">Deck</a>
      <span class="footer-separator">|</span>
      <a href="overview.html">Section</a>
      <span class="footer-separator">|</span>
      <a href="https://drive.google.com/drive/folders/1BDF-8Vz_8P5PIH_78GikTFfYA_ZtOoUS?usp=drive_link" target="_blank">Google Drive</a>
      <span class="footer-separator">|</span>
      <a href="../../../../index-versions.html">View all versions</a>
    </div>
  </footer>
  <script>
    const locations = [
      { name: 'Dubai Marina', lat: 25.0760, lng: 55.1320, type: 'Waterfront District', color: '#3498db', icon: 'üèôÔ∏è', zoom: 14 },
      { name: 'Dubai Al Bastakiya', lat: 25.2631, lng: 55.2972, type: 'Historic District', color: '#e67e22', icon: 'üèõÔ∏è', zoom: 15 },
      { name: 'Dubai Creek', lat: 25.2631, lng: 55.3095, type: 'Waterway', color: '#1abc9c', icon: '‚õµ', zoom: 13 },
      { name: 'Al Seef District, Dubai', lat: 25.2580, lng: 55.2983, type: 'Cultural District', color: '#e74c3c', icon: 'üèõÔ∏è', zoom: 14 },
      { name: 'Dubai City Walk', lat: 25.2167, lng: 55.2619, type: 'Shopping & Dining', color: '#9b59b6', icon: 'üõçÔ∏è', zoom: 15 },
      { name: 'Sheraton The Walk, Dubai', lat: 25.0800, lng: 55.1350, type: 'Hotel', color: '#f39c12', icon: 'üè®', zoom: 15 },
      { name: 'Abu Dhabi Louvre', lat: 24.5337, lng: 54.3986, type: 'Museum', color: '#34495e', icon: 'üé®', zoom: 15 },
      { name: 'Sheikh Zayed Grand Mosque', lat: 24.4128, lng: 54.4750, type: 'Mosque', color: '#f39c12', icon: 'üïå', zoom: 14 },
      { name: 'Emirates Palace', lat: 24.4619, lng: 54.3175, type: 'Hotel & Landmark', color: '#e67e22', icon: 'üè∞', zoom: 15 }
    ];

    // Calculate center for UAE (between Dubai and Abu Dhabi)
    const centerLat = 24.8;
    const centerLng = 54.8;
    const initialZoom = 9;

    // Initialize Map 1: OpenStreetMap
    const map1 = L.map('map1').setView([centerLat, centerLng], initialZoom);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      maxZoom: 19
    }).addTo(map1);

    // Initialize Map 2: OpenTopoMap
    const map2 = L.map('map2').setView([centerLat, centerLng], initialZoom);
    L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',
      maxZoom: 17
    }).addTo(map2);

    // Add markers
    const markers1 = [];
    const markers2 = [];

    locations.forEach((loc, index) => {
      const customIcon = L.divIcon({
        className: 'custom-marker',
        html: `
          <div style="position: relative; text-align: center;">
            <svg width="40" height="55" viewBox="0 0 40 55" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <filter id="shadow-${index}" x="-50%" y="-50%" width="200%" height="200%">
                  <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.4"/>
                </filter>
              </defs>
              <path d="M20 0C9 0 0 9 0 20c0 13.4 20 35 20 35s20-21.6 20-35C40 9 31 0 20 0z"
                    fill="${loc.color}"
                    stroke="white"
                    stroke-width="2.5"
                    filter="url(#shadow-${index})"/>
              <circle cx="20" cy="20" r="8" fill="white" opacity="0.9"/>
              <text x="20" y="25" text-anchor="middle" font-size="12">${loc.icon}</text>
            </svg>
          </div>
        `,
        iconSize: [40, 55],
        iconAnchor: [20, 55],
        popupAnchor: [0, -55]
      });

      const popupContent = `
        <div class="popup-header" style="background: ${loc.color};">
          <h3 style="margin: 0; font-size: 16px;">${loc.icon} ${loc.name}</h3>
        </div>
        <div class="popup-body">
          <p style="margin: 8px 0; color: #666;"><strong>${loc.type}</strong></p>
          <hr style="margin: 10px 0; border: none; border-top: 1px solid #eee;">
          <p style="margin: 5px 0; font-size: 12px; color: #999;">
            <strong>Coordinates:</strong> ${loc.lat.toFixed(4)}, ${loc.lng.toFixed(4)}
          </p>
        </div>
      `;

      const marker1 = L.marker([loc.lat, loc.lng], { icon: customIcon })
        .addTo(map1)
        .bindPopup(popupContent, { className: 'custom-popup', maxWidth: 300 });
      markers1.push(marker1);

      const marker2 = L.marker([loc.lat, loc.lng], { icon: customIcon })
        .addTo(map2)
        .bindPopup(popupContent, { className: 'custom-popup', maxWidth: 300 });
      markers2.push(marker2);
    });

    // Add scale controls
    L.control.scale({ imperial: false, metric: true }).addTo(map1);
    L.control.scale({ imperial: false, metric: true }).addTo(map2);

    // Create navigation controls
    function createControls(controlsId, map, markers) {
      const div = document.getElementById(controlsId);

      locations.forEach((loc, i) => {
        const btn = document.createElement('button');
        btn.textContent = loc.name;
        btn.onclick = () => {
          map.setView([loc.lat, loc.lng], loc.zoom || 14);
          markers[i].openPopup();
        };
        div.appendChild(btn);
      });

      const showAll = document.createElement('button');
      showAll.textContent = 'Show All Locations';
      showAll.onclick = () => {
        const bounds = L.latLngBounds(locations.map(l => [l.lat, l.lng]));
        map.fitBounds(bounds, { padding: [50, 50] });
      };
      div.appendChild(showAll);
    }

    createControls('controls1', map1, markers1);
    createControls('controls2', map2, markers2);

    const mapsLinks = document.getElementById('maps-links');
    locations.forEach((loc) => {
      const li = document.createElement('li');
      const link = document.createElement('a');
      link.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(loc.name)}`;
      link.textContent = loc.name;
      li.appendChild(link);
      mapsLinks.appendChild(li);
    });

    // Ensure buildBreadcrumb is available before calling
    if (typeof buildBreadcrumb === 'function') {
      buildBreadcrumb('page-nav', [
        { href: '../../../index.html', label: 'Dubai1 Home' },
        { href: '../../../../index.html', label: 'All decks' }
      ]);
    } else {
      // Wait for script to load
      document.addEventListener('DOMContentLoaded', () => {
        buildBreadcrumb('page-nav', [
          { href: '../../../index.html', label: 'Dubai1 Home' },
          { href: '../../../../index.html', label: 'All decks' }
        ]);
      });
    }
  </script>
  <footer class="site-footer">
    <script>
      (function() {
        var footer = document.currentScript.parentElement;
        var nav = document.createElement('div');
        nav.className = 'footer-nav';
        var links = [];
        
        // Version link to home
        links.push({ href: '../../../../index.html', text: 'Version: PR #46' });
        
        // Deck link
        links.push({ href: '../../index.html', text: 'Deck' });
        
        // Section link
        links.push({ href: 'overview.html', text: 'Section' });
        
        // Google Drive link
        links.push({ href: 'https://drive.google.com/drive/folders/1BDF-8Vz_8P5PIH_78GikTFfYA_ZtOoUS?usp=drive_link', text: 'Google Drive', external: true });
        
        // View all versions link
        links.push({ href: '../../../../index-versions.html', text: 'View all versions' });
        
        // Build the navigation
        links.forEach(function(link, index) {
          if (index > 0) {
            var sep = document.createElement('span');
            sep.className = 'footer-separator';
            sep.textContent = '|';
            nav.appendChild(sep);
          }
          var a = document.createElement('a');
          a.href = link.href;
          a.textContent = link.text;
          if (link.external) a.target = '_blank';
          nav.appendChild(a);
        });
        
        footer.appendChild(nav);
      })();
    </script>
  </footer>
</body>
</html>
